---
import { getCollection } from "astro:content";
import PostItem from "@/components/PostItem.astro";
import Root from "@/layouts/Root.astro";

const posts = (await getCollection("blog")).sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<Root title="Blog" description="Toby Nguyen's Blog">
    <div class="lg:1/2 mx-auto h-full w-11/12 sm:w-4/6 md:w-3/5">
        <div class="mt-12">
            <h1 class="text-primary py-5 text-3xl font-semibold">Blog</h1>
        </div>
        <div class="flex flex-col gap-5">
            {
                posts.map(({ data, id }) =>
                    data.redirect ? (
                        <PostItem
                            title={data.title}
                            date={data.pubDate}
                            description={data.description}
                            link={data.redirect}
                            isRedirect
                            isDraft={data.isDraft}
                        />
                    ) : (
                        <PostItem
                            title={data.title}
                            date={data.pubDate}
                            description={data.description}
                            link={`/blog/${id}`}
                            isDraft={data.isDraft}
                        />
                    ),
                )
            }
        </div>
    </div>
</Root>
